  

직역하면 질문하다. 라는 뜻을 가지는 단어다.

데이터베이스에 요청하는 역할을 한다.

  

키워드는 다음과 같다.

|   |   |
|---|---|
|DISTINCT|같은 값이 있을 경우, 하나만 보여준다.|
|AND|WHERE 조건절에 그리고 조건을 사용할 때 사용한다.|
|OR|WHERE 조건절에 '혹은' 이라는 의미로써 사용한다.|
|ORDER|특정 컬럼의 값을 토대로 정렬하여 보여준다.  <br>ASC(기본값): 오름차순 DESC: 내림차순|
|NOT|특정 조건을 만족하지 않는 경우를 지정할 때 사용|
|LIMIT|출력되는 줄의 갯수를 제한할 때 사용  <br>특정 줄부터 몇 개의 줄을 출력할지 정할 때에도 사용한다  <br>시작되는 줄은 index와 같은 개념으로, 0부터 시작|
|MIN|특정 컬럼에서 가장 작은 값을 찾아서 출력|
|MAX|특정 컬럼에서 가장 큰 값을 찾아서 출력|
|COUNT|특정 컬럼의 갯수를 세어서 출력|
|SUM|특정 컬럼의 총합 출력|
|AVG|특정 컬럼의 평균 출력|
|LIKE|WHERE에서 비슷한 값을 찾아준다.|
|IN|특정 값들 중 하나라도 만족하는 경우 검색|
|BETWEEN|특정 범위의 값 검색|
|AS|검색 또는 쿼리문에서 별명을 붙여줘야 하는 경우|
|JOIN|2개의 테이블을 연결해 결과를 출력할 때 사용하는 키워드.|
|UNION|2개 이상의 SELECT 쿼리 결과를 합쳐서 볼 경우 사용하는 키워드|
|GROUP BY|한 컬럼에 중복된 값이 있을 경우, 한 줄로 처리하는 키워드|
|SUBQUERY|IN의 조건절에 쿼리를 넣어 해당 쿼리의 조건을 만족하는 데이터만 뽑아내는 키워드|

- 쿼리문 예시
    
    ```SQL
    #다양한 SQL 쿼리문을 알아보자.
        \#1. DISTINCT
        #	같은 값이 있을 경우, 하나만 보여준다.
        SELECT COUNTRYCODE FROM city;
        SELECT DISTINCT COUNTRYCODE FROM city;
        
        \#2. AND
        #	WHERE 조건절에 복합적인 조건을 사용할 때 사용한다.
        SELECT * FROM city;
        #	컨트리코드가 AFG이고 인구가 100000 이상인 도시
        SELECT * FROM city WHERE countrycode = 'AFG' AND population >= 1000000;
        
        \#3. OR
        #	WHERE 조건절에 '혹은' 이라는 의미로써 사용한다.
        #	컨트리코드가 AFG 혹은 인구가 1000000 이상인 도시
        SELECT * FROM city WHERE countrycode = 'AFG' OR population >= 1000000;
        
        \#4. ORDER BY
        #	특정 컬럼의 값을 토대로 정렬하여 보여준다.
        #	기본적으로 아무것도 적어주지 않으면 오름차순 이지만
        #	ORDER BY 컬럼이름 ASC -> 해당 컬럼이름의 값으로 오름차순 정렬
        #	ORDER BY 컬럼이름 DESC -> 해당 컬럼이름의 값으로 내림차순 정렬
        SELECT * FROM city ORDER BY population ASC;
        SELECT * FROM city ORDER BY population DESC;
        
        \#5. NOT
        #	특정 조건을 만족하지 않는 경우를 지정할 때 사용
        SELECT * FROM city WHERE NOT countrycode = 'AFG';
        
        \#6. LIMIT
        #	출력되는 줄의 갯수를 제한할 때 사용
        #	MySql workbench에선 기본 출력이 LIMIT 1000이다.
        #	Query -> Limit Lows에서 기본 출력 양 설정 가능
        SELECT * FROM city LIMIT 10;
        #	또한 특정 줄부터 몇개 줄을 출력할지 정할 때에도 사용한다.
        #	시작되는 줄은 index와 같은 개념으로, 0부터 시작
        SELECT * FROM city LIMIT 10, 20;
        
        \#7. MIN()
        #	특정 컬럼에서 가장 작은 값을 찾아서 출력
        SELECT MIN(population) FROM city;
        
        \#8. MAX()
        #	특정 컬럼에서 가장 큰 값을 찾아서 출력
        SELECT MAX(population) FROM city;
        
        \#9. COUNT()
        #	특정 컬럼의 갯수를 세어서 출력
        SELECT COUNT(name) FROM city;
        #	중복된 이름을 제외하고 세기
        SELECT COUNT(DISTINCT name) FROM city;
        
        \#10. SUM()
        #	특정 컬럼의 총합 출력
        SELECT SUM(population) FROM city;
        
        \#11. AVG()
        #	특정 컬럼의 평균 출력
        SELECT AVG(population) FROM city;
        
        \#12. LIKE
        #	WHERE에서 비슷한 값을 찾아준다.
        #	%를 뒤에 붙이면 해당 글자들로 시작하는 모든 값을 찾는다.
        #	%를 앞에 붙이면 해당 글자들로 끝나는 모든 값을 찾는다.
        #	%를 앞뒤에 붙이면 해당 글자가 중간에 들어가는 모든 값을 찾아준다.
        SELECT * FROM city WHERE name LIKE 'se%';
        SELECT * FROM city WHERE name LIKE '%se%';
        SELECT * FROM city WHERE name LIKE '%se';
        
        \#13. IN
        #	특정 값들 중 하나라도 만족하는 경우 검색
        SELECT * FROM city WHERE countrycode IN ('KOR', 'BRA', 'JPN');
        
        \#14. BETWEEN
        #	특정 범위의 값 검색
        #	BETWEEN 시작값 AND 끝값
        SELECT * FROM city WHERE ID BETWEEN 11 AND 20;
        
        \#15. AS
        #	검색 또는 쿼리문에서 별명을 붙여줘야 하는 경우
        #	AS 별명 으로 붙여준다.
        SELECT id, NAME AS '도시', countrycode AS '국가' FROM city;
    	
        \#16. JOIN
        #	2개의 테이블을 연결하여
        #	결과창에서 연결한 테이블 모두 확인하여
        #	원하는 결과를 뽑을 때 사용되는 키워드
        #	이너조인, 레프트조인, 라이트조인, 풀 아우터조인이 있지만
        #	실질적으로 가장 많이 사용되는건 이너조인 이다.
        SELECT * FROM city;
        SELECT * FROM country;
        
        \#16-A INNER JOIN
        #	city에서 countrycode 기준으로 country 테이블을 연결해 출력
        SELECT id, C.name, countrycode, N.name FROM city AS C
        INNER JOIN country AS N
        ON C.countrycode = N.code;
        
        \#16-B LEFT JOIN
        #	city에서 id를 기준으로 country 테이블의 capital을 연결해 출력
        SELECT * FROM city
        LEFT JOIN country
        ON city.id = country.capital;
        
        \#16-C RIGHT JOIN
        SELECT * FROM city
        RIGHT JOIN country
        ON city.id = country.capital;
        
        \#16-D FULL OUTER JOIN
        #이제 MySQL에서 지원 안 함
        
        \#17. UNION
        \#2개 이상의 SELECT 쿼리 결과를 합쳐서 볼 경우
        SELECT * FROM city
        LEFT JOIN country
        ON city.id = country.capital
        UNION
        SELECT * FROM city
        RIGHT JOIN country
        ON city.id = country.capital;
    
    	\#18. GROUP BY
        #한 컬럼에 여러 값이 중복되어 있을 경우, 한 줄로 묶음 처리
        SELECT countrycode, sum(population) FROM city
        GROUP BY countrycode;
        
        \#19. SUBQUERY
        #	IN의 조건절에 쿼리를 넣어
        #	해당 쿼리를 만족하는 것들만 다시 뽑아내는 방식
        SELECT * FROM country
        WHERE code IN (SELECT countrycode FROM city);
    
    	SELECT * FROM country
        WHERE capital IN (SELECT id from city);
        
        #	복합적으로 사용
        SELECT * FROM city
        INNER JOIN country ON city.id = country.capital
        WHERE city.population >= 5000000
        ORDER BY city.name DESC;
    ```
    

  

문제를 풀어보도록 하자.

  

- 1. 배우의 이름을 알파벳 내림차순 10명을 보여주세요.
    
    ```SQL
    SELECT first_name FROM actor
    ORDER BY first_name DESC
    LIMIT 10;
    ```
    
- 2. 영화의 카테고리를 보여주세요.
    
    ```SQL
    SELECT name FROM category
    GROUP BY name;
    ```
    
- 3. 고객 중에 휴면 회원들을 모두 보여주세요.
    
    ```SQL
    SELECT * FROM customer
    WHERE active = 0;
    ```
    
- 4. 영화를 대여기간 순으로 오름차순 정렬하세요
    
    ```SQL
    SELECT * FROM film
    ORDER BY rental_duration;
    ```
    
- 5. 영화를 대여료 순으로 내림차순 정렬하세요.
    
    ```SQL
    SELECT * FROM film
    ORDER BY rental_rate DESC;
    ```
    
- 6. 영화 중 개(dog)가 나오는 것을 모두 보여주세요.
    
    ```SQL
    SELECT * FROM film
    WHERE title LIKE '%dog%'; 
    ```
    
- 7. 영화 중 2000년 이전에 나온 영화들을 모두 보여주세요.
    
    ```SQL
    SELECT * FROM film
    WHERE release_year < 2000;
    ```
    
- 8. 필름 액터 테이블로 페넬로페 귀네스가 나온 영화의 제목들을 출력해주세요.
    
    ```SQL
    SELECT title FROM film_actor
    INNER JOIN film
    ON film_actor.film_id = film.film_id
    INNER JOIN actor
    ON film_actor.actor_id = actor.actor_id
    WHERE first_name = 'penelope' AND last_name = 'guiness';
    ```
    
- 9. 가장 많은 영화에 출연한 배우의 성과 이름과 출연한 영화의 갯수를 출력해주세요.
    
    ```SQL
    SELECT actor.first_name, actor.last_name, COUNT(*) FROM actor
    INNER JOIN film_actor
    ON actor.actor_id = film_actor.actor_id
    INNER JOIN film
    ON film.film_id = film_actor.film_id
    GROUP BY actor.actor_id
    ORDER BY COUNT(*) DESC
    LIMIT 1;
    ```
    
- 10. 회원 번호와 그 회원이 대여료를 총 얼마 냈는지 보여주세요.
    
    ```SQL
    SELECT customer_id, SUM(amount) FROM payment
    GROUP BY customer_id;
    ```
    
- 11. 1번 store가 가지고 있는 총 비디오의 갯수를 보여주세요.
    
    ```SQL
    SELECT store_id, COUNT(*) FROM inventory
    WHERE store_id = 1
    GROUP BY store_id;
    ```
    
- 12. 1번 store가 가지고 있는 영화와 해당 영화의 비디오 갯수를 보여주세요.
    
    ```SQL
    SELECT title, COUNT(*) FROM inventory
    INNER JOIN film
    ON inventory.film_id = film.film_id
    WHERE store_id = 1
    GROUP BY film.film_id;
    ```
    
- 13. 영화의 제목과 카테고리를 텍스트로 보여주세요.
    
    ```SQL
    SELECT title, category.name FROM film
    INNER JOIN film_category
    ON film.film_id = film_category.film_id
    INNER JOIN category
    ON film_category.category_id = category.category_id;
    ```
    
- 14. 도시와 해당 국가를 보여주세요.
    
    ```SQL
    SELECT city, country FROM city
    INNER JOIN country
    ON city.country_id = country.country_id;
    ```
    
- 15. 고객 중 미국에 살고 있는 회원의 이름과 이메일을 보여주세요.
    
    ```SQL
    SELECT customer.first_name, customer.last_name, customer.email FROM customer
    INNER JOIN address
    ON customer.address_id = address.address_id
    INNER JOIN city
    ON address.city_id = city.city_id
    INNER JOIN country
    ON city.country_id = country.country_id
    WHERE country.country = 'united states';
    
    #서브 쿼리
    SELECT first_name, last_name, email FROM customer
    WHERE address_id IN
    (SELECT address_id FROM address
    	WHERE city_id IN
    	(SELECT city_id FROM city
    		WHERE country_id = (SELECT country_id FROM country WHERE country = 'United States')));
    ```
    
- 16. 영화 중 대여 횟수가 가장 많은 영화의 이름을 보여주세요.
    
    ```SQL
    SELECT film.title, COUNT(*) FROM film
    INNER JOIN inventory
    ON film.film_id = inventory.film_id
    INNER JOIN rental
    ON inventory.inventory_id = rental.inventory_id
    GROUP BY film.film_id
    ORDER BY COUNT(*) DESC
    LIMIT 1;
    ```
    
- 17. 영화 중 대여기간이 4일 미만이고 주연의 이름이 JOHNNY LOLLOBRIGIDA 이고 비디오 부록에 예고편이 있는 영화의 제목을 보여주세요.
    
    ```SQL
    SELECT film.title FROM film
    INNER JOIN film_actor
    ON film.film_id = film_actor.film_id
    INNER JOIN actor
    ON film_actor.actor_id = actor.actor_id
    WHERE film.rental_duration < 4
    AND actor.first_name = 'JOHNNY' AND actor.last_name = 'LOLLOBRIGIDA'
    AND film.special_features LIKE '%Trailers%';
    ```
    
- 18. 직원 중 Mike Hilyer가 LINDA WILLAMS 에게 대여해준 영화의 제목, 대여일, 반납일을 보여주세요.
    
    ```SQL
    SELECT film.title, rental.rental_date, rental.return_date FROM staff
    INNER JOIN rental
    ON staff.staff_id = rental.staff_id
    INNER JOIN customer
    ON rental.customer_id = customer.customer_id
    INNER JOIN inventory
    ON rental.inventory_id = inventory.inventory_id
    INNER JOIN film
    ON inventory.film_id = film.film_id
    WHERE staff.first_name = 'mike' AND staff.last_name = 'hillyer'
    AND customer.first_name = 'linda' AND customer.last_name = 'williams';
    ```
    
- 19. 영화의 이름과 출연한 배우의 숫자를 배우의 숫자로 내림차순해서 보여주되 출연한배우의 숫자 컬럼의 이름을 출연배우수로 만들어 보여세요.
    
    ```SQL
    SELECT film.title, COUNT(*) AS '출연한배우' FROM film
    INNER JOIN film_actor
    ON film.film_id = film_actor.film_id
    INNER JOIN actor
    ON film_actor.actor_id = actor.actor_id
    GROUP BY film.film_id
    ORDER BY COUNT(*) DESC;
    ```
    
- 20. 회원의 이름, 빌린 비디오의 숫자, 빌린 비디오 대여점의 주소, 회원의 거주 도시를 회원 번호순으로 정렬하여 보여주세요.
    
    ```SQL
    SELECT cu.first_name, cu.last_name, COUNT(cu.customer_id), ci.city, ad2.address FROM customer AS cu
    INNER JOIN rental AS re
    ON cu.customer_id = re.customer_id
    INNER JOIN address AS ad
    ON cu.address_id = ad.address_id
    INNER JOIN city AS ci
    ON ad.city_id = ci.city_id
    INNER JOIN store AS st
    ON cu.store_id = st.store_id
    INNER JOIN address AS ad2
    ON st.address_id = ad2.address_id
    GROUP BY cu.customer_id;
    ```
    

  

  

  

- 문제 목록